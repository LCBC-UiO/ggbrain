<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Read in files from Freesurfer • ggseg</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Read in files from Freesurfer">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggseg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ggseg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/externalData.html">Adding external data to ggseg plotting</a>
    </li>
    <li>
      <a href="../articles/freesurfer_files.html">Read in files from Freesurfer</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/LCBC-UiO/ggseg">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Read in files from Freesurfer</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LCBC-UiO/ggseg/blob/master/vignettes/freesurfer_files.Rmd"><code>vignettes/freesurfer_files.Rmd</code></a></small>
      <div class="hidden name"><code>freesurfer_files.Rmd</code></div>

    </div>

    
    
<p>Freesurfer already have files that are compatible with <code>ggseg</code> in some extent. There are naming conventions and file-formats that are different, and as such it can at times be a little tricky to get data directly from Freesurfer into R, and subsequently plotting in ggseg.</p>
<div id="raw-stats-files" class="section level1">
<h1 class="hasAnchor">
<a href="#raw-stats-files" class="anchor"></a>Raw stats files</h1>
<div id="read-in-single-raw-stats-file" class="section level2">
<h2 class="hasAnchor">
<a href="#read-in-single-raw-stats-file" class="anchor"></a>Read in single raw stats file</h2>
<p>If <code>recon-all</code> from Freesurfer has been run, each participant should have a <code>stats</code> folder, with various parcellation data and summary statistics for those parcellations and measures. These have many header lines before the data acutally start, and can have some formatting difficult to handle in R.</p>
<p>The function <code>read_freesurfer_stats</code> is made to easily read in raw stats tables from each individual, without needing to go through Freesurfers internal converters. When using this file, remembering which hemisphere is read in is important, as this information must be added to the <code>label</code> column for <code>ggseg</code> to recognise the region labels.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggseg)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">subject_dir &lt;-<span class="st"> "/Applications/freesurfer/subjects/"</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">stats_file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(subject_dir, <span class="st">"bert/stats/lh.aparc.stats"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_freesurfer_stats.html">read_freesurfer_stats</a></span>(stats_file)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">data</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; # A tibble: 34 x 10</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;    label NumVert SurfArea GrayVol ThickAvg ThickStd MeanCurv GausCurv FoldInd</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt;    &lt;int&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;  1 bank…    1181      831    2297     2.77    0.428    0.116    0.024      11</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;  2 caud…     843      572    1534     2.72    0.469    0.124    0.013      10</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;  3 caud…    2758     1840    5772     2.80    0.526    0.114    0.021      26</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;  4 cune…    2683     1654    3074     1.81    0.471    0.14     0.033      39</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;  5 ento…     581      416    1840     3.33    0.667    0.116    0.032       5</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;  6 fusi…    4113     2875    8519     2.72    0.599    0.131    0.025      52</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;  7 infe…    4948     3466   10559     2.70    0.509    0.131    0.029      65</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt;  8 infe…    5056     3542   12358     2.98    0.625    0.138    0.033      74</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt;  9 isth…    1561      990    2350     2.09    0.745    0.113    0.023      19</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; 10 late…    7961     5077   12743     2.30    0.588    0.139    0.033     104</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; # … with 24 more rows, and 1 more variable: CurvInd &lt;dbl&gt;</span></a></code></pre></div>
<p>This data should be well-suited for use with ggseg.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">label =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"lh_"</span>, label)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(<span class="dt">atlas =</span> dk, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">fill =</span> ThickAvg))</a></code></pre></div>
<p><img src="freesurfer_files_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="read-in-raw-stats-files-for-an-atlas-for-all-subjects" class="section level2">
<h2 class="hasAnchor">
<a href="#read-in-raw-stats-files-for-an-atlas-for-all-subjects" class="anchor"></a>Read in raw stats files for an atlas for all subjects</h2>
<p>A convenience function also exists for those wanting to circumvent the <code>aparcstats2table</code> and <code>asegstats2table</code> from freesurfer for creating larger datasets of all subjects for a specific parcellation and metric. Using the function <code>read_freesurfer_stats</code>, <code>read_atlas_files</code> uses regular expression for the atlas you want to extract data from, and grabs this data from all available subjects. Be careful with your pattern matching to be sure you get exactly the atlas you want. For instance, there are several atlases with with string <code>aparc</code> in them. So in order to get only the default aparc stats, we need to specify <code>aparc.stats$</code>, which will only read those files ending with that particular string. This function <em>can</em> throw warnings, which is most cases can be ignored.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_atlas_files.html">read_atlas_files</a></span>(subject_dir, <span class="st">"aparc.stats$"</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">dat</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; # A tibble: 68 x 11</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;    subject label NumVert SurfArea GrayVol ThickAvg ThickStd MeanCurv GausCurv</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;    &lt;int&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;  1 bert    lh_b…    1181      831    2297     2.77    0.428    0.116    0.024</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;  2 bert    lh_c…     843      572    1534     2.72    0.469    0.124    0.013</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;  3 bert    lh_c…    2758     1840    5772     2.80    0.526    0.114    0.021</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;  4 bert    lh_c…    2683     1654    3074     1.81    0.471    0.14     0.033</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  5 bert    lh_e…     581      416    1840     3.33    0.667    0.116    0.032</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  6 bert    lh_f…    4113     2875    8519     2.72    0.599    0.131    0.025</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  7 bert    lh_i…    4948     3466   10559     2.70    0.509    0.131    0.029</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  8 bert    lh_i…    5056     3542   12358     2.98    0.625    0.138    0.033</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  9 bert    lh_i…    1561      990    2350     2.09    0.745    0.113    0.023</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; 10 bert    lh_l…    7961     5077   12743     2.30    0.588    0.139    0.033</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; # … with 58 more rows, and 2 more variables: FoldInd &lt;int&gt;, CurvInd &lt;dbl&gt;</span></a></code></pre></div>
<p>Since all files are read in, the hemisphere in the label is already fixed, so it is easy to plot.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(dat, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">fill =</span> ThickStd))</a></code></pre></div>
<p><img src="freesurfer_files_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>With this data, we can even have a look at all the metrics at once.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(stat, val, <span class="op">-</span>subject, <span class="op">-</span>label) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(stat) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">fill =</span> val)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>stat)</a></code></pre></div>
<p><img src="freesurfer_files_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
</div>
</div>
<div id="freesurfer-stats-tables" class="section level1">
<h1 class="hasAnchor">
<a href="#freesurfer-stats-tables" class="anchor"></a>Freesurfer stats tables</h1>
<p>Freesurfer has internal functions to convert their raw stats files into tables, gather subject into a single data file with particular metric. It is quite common to use these files, but again the formatting is not something R is very happy with. The function <code><a href="../reference/read_freesurfer_table.html">read_freesurfer_table()</a></code> is for easier import of these files, particularly for further plotting with ggseg.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Path to our particular file, yours will be wherever you have saved it</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">table_path &lt;-<span class="st"> </span>here<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="st">"tests/testthat/data/aparc.volume.table"</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">table_path</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; [1] "/home/travis/build/LCBC-UiO/ggseg/tests/testthat/data/aparc.volume.table"</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/read_freesurfer_table.html">read_freesurfer_table</a></span>(table_path)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; # A tibble: 36 x 3</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt;    subject label                             value</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt;    &lt;fct&gt;   &lt;chr&gt;                             &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt;  1 bert    rh_bankssts_volume                 1969</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt;  2 bert    rh_caudalanteriorcingulate_volume  2280</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  3 bert    rh_caudalmiddlefrontal_volume      5390</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;  4 bert    rh_cuneus_volume                   2998</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;  5 bert    rh_entorhinal_volume               1735</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;  6 bert    rh_fusiform_volume                 8144</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;  7 bert    rh_inferiorparietal_volume        14876</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;  8 bert    rh_inferiortemporal_volume        11016</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  9 bert    rh_isthmuscingulate_volume         1983</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; 10 bert    rh_lateraloccipital_volume        12729</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; # … with 26 more rows</span></a></code></pre></div>
<p>The file is read and has three columns only. The subject column, the label column, and a column with the values of the metric. Since the stats tables can contain different measures, and these are handled somewhat differently, we for convenience leave the default reading of the table this way. To work with ggseg, though, the labels usually (but not always) need a little cleaning. In this case we read in a <code>volume</code> table, and as such all labels end with "_volume". ggseg will <em>not</em> recognise this matching the atlas, and will therefore not plot.</p>
<p>Easiest way to clean, is by using the <code>measure</code> argument for the function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_freesurfer_table.html">read_freesurfer_table</a></span>(table_path, <span class="dt">measure =</span> <span class="st">"volume"</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">dat</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; # A tibble: 36 x 3</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt;    subject label                      volume</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;    &lt;fct&gt;   &lt;chr&gt;                       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt;  1 bert    rh_bankssts                  1969</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt;  2 bert    rh_caudalanteriorcingulate   2280</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt;  3 bert    rh_caudalmiddlefrontal       5390</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;  4 bert    rh_cuneus                    2998</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;  5 bert    rh_entorhinal                1735</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt;  6 bert    rh_fusiform                  8144</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt;  7 bert    rh_inferiorparietal         14876</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt;  8 bert    rh_inferiortemporal         11016</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;  9 bert    rh_isthmuscingulate          1983</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; 10 bert    rh_lateraloccipital         12729</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; # … with 26 more rows</span></a></code></pre></div>
<p>This will do two things: 1) remove the label suffix, and 2) rename the <code>value</code> column to the measure supplied. Alternatively, you will need to do string manipulation on the label column your self, we recommend the <a href="https://stringr.tidyverse.org/index.html">stringr</a> package in that case.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(dat, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">fill =</span> volume))</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; Warning: Unknown or uninitialised column: 'value'.</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; Warning in data_merge(.data, geobrain): Some .data is not merged properly into</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; the geobrain. Check for spelling mistakes in:</span></a></code></pre></div>
<p><img src="freesurfer_files_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>The error thrown is because the Freesurfer tables also include measures of total volume/region/thickness, estimated intracranial volume etc, which will not merge into the atlas, and the internal ggseg atlas-merging function throws a warning. To avoid this, you can remove those labels before plotting.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"lh|rh"</span>, label)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">fill =</span> volume))</a></code></pre></div>
<p><img src="freesurfer_files_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#raw-stats-files">Raw stats files</a><ul class="nav nav-pills nav-stacked">
<li><a href="#read-in-single-raw-stats-file">Read in single raw stats file</a></li>
      <li><a href="#read-in-raw-stats-files-for-an-atlas-for-all-subjects">Read in raw stats files for an atlas for all subjects</a></li>
      </ul>
</li>
      <li><a href="#freesurfer-stats-tables">Freesurfer stats tables</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Athanasia Mo Mowinckel, Didac Vidal-Piñeiro.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
