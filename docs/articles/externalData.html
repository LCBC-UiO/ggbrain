<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding external data to ggseg plotting • ggseg</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adding external data to ggseg plotting">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggseg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ggseg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/externalData.html">Adding external data to ggseg plotting</a>
    </li>
    <li>
      <a href="../articles/ggseg3d.html">Plotting brain mesh atlases in plotly</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Adding external data to ggseg plotting</h1>
            
      
      
      <div class="hidden name"><code>externalData.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Once you have covered the main functionality in <code>ggseg</code> you will want to use it to plot the results of your data. In order to do this, your data must adhere to certain specifications, so that <code>ggseg</code> can manage to merge your data with the atlas you are using. This means you need to be able to inspect and locate the way the regions you are working with are names in the internal atlas files. This vignette should provide the tools you need to figure these features out, and to manipulate your data to fit these requirements.</p>
</div>
<div id="inspecting-the-atlas-labels" class="section level2">
<h2 class="hasAnchor">
<a href="#inspecting-the-atlas-labels" class="anchor"></a>Inspecting the atlas labels</h2>
<p>There are several ways you can inspect what the data in the atlas looks like. While each atlas has some small differences, they all share six main columns:<br><strong>1. long</strong> - x-axis<br><strong>2. lat </strong>- y-axis<br><strong>3. area </strong>- name of area/network<br><strong>4. hemi</strong> - hemisphere (left or right)<br><strong>5. side</strong> - side of view (medial, lateral, sagittal or axial)</p>
<p>Most atlases also have a <code>label</code> column, which are raw names assigned from the program run to segment/extract data.</p>
<p>This information is stored in a list of data.frames called <code>atlas.info</code>, which is loaded when ggseg is loaded, just like the atlases and palettes.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggseg)</a></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magrittr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">atlas.info<span class="op">$</span>dkt</a></code></pre></div>
<pre><code>##                             area  hemi    side                       label
## 1              superior temporal  left lateral         lh_superiortemporal
## 250                  pre central  left lateral               lh_precentral
## 469                 post central  left lateral              lh_postcentral
## 663       rostral middle frontal  left lateral     lh_rostralmiddlefrontal
## 862                       insula  left lateral                   lh_insula
## 1007           superior parietal  left lateral         lh_superiorparietal
## 1087           inferior temporal  left lateral         lh_inferiortemporal
## 1238           lateral occipital  left lateral         lh_lateraloccipital
## 1361       lateral orbitofrontal  left lateral     lh_lateralorbitofrontal
## 1449            superior frontal  left lateral          lh_superiorfrontal
## 1519                    fusiform  left lateral                 lh_fusiform
## 1550               temporal pole  left lateral             lh_temporalpole
## 1582               supramarginal  left lateral            lh_supramarginal
## 1785             middle temporal  left lateral           lh_middletemporal
## 2011     banks superior temporal  left lateral                 lh_bankssts
## 2138         transverse temporal  left lateral       lh_transversetemporal
## 2190       caudal middle frontal  left lateral      lh_caudalmiddlefrontal
## 2342            pars opercularis  left lateral          lh_parsopercularis
## 2495           pars triangularis  left lateral         lh_parstriangularis
## 2625              pars orbitalis  left lateral            lh_parsorbitalis
## 2690           inferior parietal  left lateral         lh_inferiorparietal
## 3247            superior frontal  left  medial          lh_superiorfrontal
## 3472                   precuneus  left  medial                lh_precuneus
## 3697                para central  left  medial              lh_paracentral
## 3849       medial orbito frontal  left  medial      lh_medialorbitofrontal
## 4015                      cuneus  left  medial                   lh_cuneus
## 4127                    fusiform  left  medial                 lh_fusiform
## 4192           superior parietal  left  medial         lh_superiorparietal
## 4235           lateral occipital  left  medial         lh_lateraloccipital
## 4286               temporal pole  left  medial             lh_temporalpole
## 4322                frontal pole  left  medial              lh_frontalpole
## 4350         posterior cingulate  left  medial       lh_posteriorcingulate
## 4529           isthmus cingulate  left  medial         lh_isthmuscingulate
## 4753   caudal anterior cingulate  left  medial  lh_caudalanteriorcingulate
## 4921  rostral anterior cingulate  left  medial lh_rostralanteriorcingulate
## 5110             parahippocampal  left  medial          lh_parahippocampal
## 5213                  entorhinal  left  medial               lh_entorhinal
## 5272                     lingual  left  medial                  lh_lingual
## 5397               pericalcarine  left  medial            lh_pericalcarine
## 5500             middle temporal right lateral           rh_middletemporal
## 5730           superior temporal right lateral         rh_superiortemporal
## 5950                 pre central right lateral               rh_precentral
## 6181                post central right lateral              rh_postcentral
## 6421      rostral middle frontal right lateral     rh_rostralmiddlefrontal
## 6593                      insula right lateral                   rh_insula
## 6769           lateral occipital right lateral         rh_lateraloccipital
## 6905           superior parietal right lateral         rh_superiorparietal
## 7006           inferior temporal right lateral         rh_inferiortemporal
## 7140       lateral orbitofrontal right lateral     rh_lateralorbitofrontal
## 7246            superior frontal right lateral          rh_superiorfrontal
## 7306                    fusiform right lateral                 rh_fusiform
## 7331           inferior parietal right lateral         rh_inferiorparietal
## 7553     banks superior temporal right lateral                 rh_bankssts
## 7681               supramarginal right lateral            rh_supramarginal
## 7911         transverse temporal right lateral       rh_transversetemporal
## 7958       caudal middle frontal right lateral      rh_caudalmiddlefrontal
## 8091            pars opercularis right lateral          rh_parsopercularis
## 8250           pars triangularis right lateral         rh_parstriangularis
## 8383              pars orbitalis right lateral            rh_parsorbitalis
## 8447               temporal pole right lateral             rh_temporalpole
## 8768            superior frontal right  medial          rh_superiorfrontal
## 8953                   precuneus right  medial                rh_precuneus
## 9170                para central right  medial              rh_paracentral
## 9311       medial orbito frontal right  medial      rh_medialorbitofrontal
## 9486                      cuneus right  medial                   rh_cuneus
## 9572                    fusiform right  medial                 rh_fusiform
## 9641           superior parietal right  medial         rh_superiorparietal
## 9703               temporal pole right  medial             rh_temporalpole
## 9753                frontal pole right  medial              rh_frontalpole
## 9785           lateral occipital right  medial         rh_lateraloccipital
## 9805         posterior cingulate right  medial       rh_posteriorcingulate
## 9977           isthmus cingulate right  medial         rh_isthmuscingulate
## 10136  caudal anterior cingulate right  medial  rh_caudalanteriorcingulate
## 10302 rostral anterior cingulate right  medial rh_rostralanteriorcingulate
## 10533            parahippocampal right  medial          rh_parahippocampal
## 10612                 entorhinal right  medial               rh_entorhinal
## 10700                    lingual right  medial                  rh_lingual
## 10812              pericalcarine right  medial            rh_pericalcarine</code></pre>
<p>Here you can see information about the <code>dkt</code> atlas, and the main attributes of this atlas. If you want to use external data with your <code>ggseg</code> plot, you will need to make sure that your data has at least one column corresponding in name and content with another in the atlas you are using.</p>
</div>
<div id="structuring-data-for-merging" class="section level2">
<h2 class="hasAnchor">
<a href="#structuring-data-for-merging" class="anchor"></a>Structuring data for merging</h2>
<p>For instance, here we make some data for the “default” and “visual” networks in the <code>dkt</code> atlas, and two p values for those two networks.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">someData =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">area=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"superior temporal"</span>,<span class="st">"pre central"</span>),</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                      <span class="dt">p=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">03</span>,.<span class="dv">6</span>), </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                      <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">someData</a></code></pre></div>
<pre><code>##                area    p
## 1 superior temporal 0.03
## 2       pre central 0.60</code></pre>
<p>Notice you we have spelled bothe the column name and the area names <strong>exactly</strong> as they appear in the data. This is necessary for the merging within the <code>ggseg</code> function to work properly. This merge can be attempted before supplying the data to <code>ggseg</code> to see if there are any errors.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">dkt <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(someData) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="dv">10</span>) <span class="co">#only added to truncate output</span></a></code></pre></div>
<pre><code>## Joining, by = "area"</code></pre>
<pre><code>##       long     lat id              area hemi    side acronym     lobe
## 1  1.97303 0.96795  0 superior temporal left lateral    sprt temporal
## 2  1.96994 0.97397  0 superior temporal left lateral    sprt temporal
## 3  1.93928 1.03425  0 superior temporal left lateral    sprt temporal
## 4  1.93620 1.04022  0 superior temporal left lateral    sprt temporal
## 5  1.92931 1.05345  0 superior temporal left lateral    sprt temporal
## 6  1.86002 1.18556  0 superior temporal left lateral    sprt temporal
## 7  1.85313 1.19875  0 superior temporal left lateral    sprt temporal
## 8  1.85259 1.19989  0 superior temporal left lateral    sprt temporal
## 9  1.84749 1.21085  0 superior temporal left lateral    sprt temporal
## 10 1.84700 1.21193  0 superior temporal left lateral    sprt temporal
##                  label order atlas
## 1  lh_superiortemporal     1   dkt
## 2  lh_superiortemporal     2   dkt
## 3  lh_superiortemporal     3   dkt
## 4  lh_superiortemporal     4   dkt
## 5  lh_superiortemporal     5   dkt
## 6  lh_superiortemporal     6   dkt
## 7  lh_superiortemporal     7   dkt
## 8  lh_superiortemporal     8   dkt
## 9  lh_superiortemporal     9   dkt
## 10 lh_superiortemporal    10   dkt
##                                                                                                     pos
## 1  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 2  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 3  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 4  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 5  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 6  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 7  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 8  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 9  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 10 2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
##       p
## 1  0.03
## 2  0.03
## 3  0.03
## 4  0.03
## 5  0.03
## 6  0.03
## 7  0.03
## 8  0.03
## 9  0.03
## 10 0.03</code></pre>
<p>No errors! Yes, the <code>p</code> column is seemingly full of <code>NA</code>s, but that is just because the top of the data is the somatomotor network, which we did not supply any p values for, so it has been populated with <code>NA</code>s. We can sort the data differently, so we can see the <code>p</code>has been added correctly.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">dkt <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(someData) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(p) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="dv">10</span>) <span class="co">#only added to truncate output</span></a></code></pre></div>
<pre><code>## Joining, by = "area"</code></pre>
<pre><code>##       long     lat id              area hemi    side acronym     lobe
## 1  1.97303 0.96795  0 superior temporal left lateral    sprt temporal
## 2  1.96994 0.97397  0 superior temporal left lateral    sprt temporal
## 3  1.93928 1.03425  0 superior temporal left lateral    sprt temporal
## 4  1.93620 1.04022  0 superior temporal left lateral    sprt temporal
## 5  1.92931 1.05345  0 superior temporal left lateral    sprt temporal
## 6  1.86002 1.18556  0 superior temporal left lateral    sprt temporal
## 7  1.85313 1.19875  0 superior temporal left lateral    sprt temporal
## 8  1.85259 1.19989  0 superior temporal left lateral    sprt temporal
## 9  1.84749 1.21085  0 superior temporal left lateral    sprt temporal
## 10 1.84700 1.21193  0 superior temporal left lateral    sprt temporal
##                  label order atlas
## 1  lh_superiortemporal     1   dkt
## 2  lh_superiortemporal     2   dkt
## 3  lh_superiortemporal     3   dkt
## 4  lh_superiortemporal     4   dkt
## 5  lh_superiortemporal     5   dkt
## 6  lh_superiortemporal     6   dkt
## 7  lh_superiortemporal     7   dkt
## 8  lh_superiortemporal     8   dkt
## 9  lh_superiortemporal     9   dkt
## 10 lh_superiortemporal    10   dkt
##                                                                                                     pos
## 1  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 2  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 3  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 4  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 5  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 6  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 7  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 8  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 9  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 10 2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
##       p
## 1  0.03
## 2  0.03
## 3  0.03
## 4  0.03
## 5  0.03
## 6  0.03
## 7  0.03
## 8  0.03
## 9  0.03
## 10 0.03</code></pre>
<p>If you need your data to be matched on several columns, the approach is the same. Add the column you want to match on, with the <strong>exact</strong> same name, and make sure it’s content matches the content of the same column in the data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">someData<span class="op">$</span>hemi =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"left"</span>,<span class="st">"left"</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">someData</a></code></pre></div>
<pre><code>##                area    p hemi
## 1 superior temporal 0.03 left
## 2       pre central 0.60 left</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">dkt <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(someData) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(p) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code>## Joining, by = c("area", "hemi")</code></pre>
<pre><code>##       long     lat id              area hemi    side acronym     lobe
## 1  1.97303 0.96795  0 superior temporal left lateral    sprt temporal
## 2  1.96994 0.97397  0 superior temporal left lateral    sprt temporal
## 3  1.93928 1.03425  0 superior temporal left lateral    sprt temporal
## 4  1.93620 1.04022  0 superior temporal left lateral    sprt temporal
## 5  1.92931 1.05345  0 superior temporal left lateral    sprt temporal
## 6  1.86002 1.18556  0 superior temporal left lateral    sprt temporal
## 7  1.85313 1.19875  0 superior temporal left lateral    sprt temporal
## 8  1.85259 1.19989  0 superior temporal left lateral    sprt temporal
## 9  1.84749 1.21085  0 superior temporal left lateral    sprt temporal
## 10 1.84700 1.21193  0 superior temporal left lateral    sprt temporal
##                  label order atlas
## 1  lh_superiortemporal     1   dkt
## 2  lh_superiortemporal     2   dkt
## 3  lh_superiortemporal     3   dkt
## 4  lh_superiortemporal     4   dkt
## 5  lh_superiortemporal     5   dkt
## 6  lh_superiortemporal     6   dkt
## 7  lh_superiortemporal     7   dkt
## 8  lh_superiortemporal     8   dkt
## 9  lh_superiortemporal     9   dkt
## 10 lh_superiortemporal    10   dkt
##                                                                                                     pos
## 1  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 2  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 3  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 4  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 5  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 6  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 7  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 8  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 9  2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
## 10 2.5, 9.2, lateral, medial, 2.5, 7.5, left, right, side, hemisphere, 6.2, 19, left, right, hemisphere
##       p
## 1  0.03
## 2  0.03
## 3  0.03
## 4  0.03
## 5  0.03
## 6  0.03
## 7  0.03
## 8  0.03
## 9  0.03
## 10 0.03</code></pre>
<p>Notice how the message now states that it is joining <code>by = c("area", "hemi")</code>. The merge function has recognized that there are two equally named columns, and assumes (in this case correctly) that these are equivalent.<br><strong>Notice</strong> that everything is case-sensitive, so writing <code>Area</code> or <code>Left</code> will not result in matching.</p>
</div>
<div id="providing-data-to-ggseg" class="section level2">
<h2 class="hasAnchor">
<a href="#providing-data-to-ggseg" class="anchor"></a>Providing data to <code>ggseg</code>
</h2>
<p>When you have managed to create data that merges nicely with the atlas, you can go ahead and supply it to the function.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(someData, <span class="dt">atlas=</span>dkt, <span class="dt">mapping=</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">fill=</span>p))</a></code></pre></div>
<p><img src="externalData_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>You can actually also supply it directly as an atlas. For instance, if you had saved the merged data from the previous steps, you can supply this directly to the <code>atlas</code> option.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">newAtlas =<span class="st"> </span>dkt <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(someData)</a></code></pre></div>
<pre><code>## Joining, by = c("area", "hemi")</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(<span class="dt">atlas=</span>newAtlas, <span class="dt">mapping=</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">fill=</span>p), <span class="dt">position=</span><span class="st">"stacked"</span>)</a></code></pre></div>
<p><img src="externalData_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>It is this possibility of supplying a custom atlas that gives you particular flexibility, though a little tricky to begin with. Lets do a recap of the unwanted results:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">someData =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">  <span class="dt">area =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"transverse temporal"</span>, <span class="st">"insula"</span>,</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">               <span class="st">"pre central"</span>,<span class="st">"superior parietal"</span>),<span class="dv">2</span>), </a>
<a class="sourceLine" id="cb26-4" data-line-number="4">  <span class="dt">p =</span> <span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>,.<span class="dv">5</span>,.<span class="dv">001</span>), <span class="dv">8</span>),</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">  <span class="dt">AgeG =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"Young"</span>,<span class="dv">4</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"Old"</span>,<span class="dv">4</span>)),</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(<span class="dt">.data=</span>someData, <span class="dt">colour=</span><span class="st">"white"</span>, <span class="dt">mapping=</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">fill=</span>p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>AgeG, <span class="dt">ncol=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="externalData_files/figure-html/datasupp3-1.png" width="700"></p>
<p>See how you have three facets, when you only have 2 groups, and that the “background” brain is not printed in your two groups. This is because for ggplot, that is what the data looks like. For this to work, you can supply already grouped data to <code>ggseg</code>, but you must make sure they are grouped by the columns you will use for facetting, or else it will not work.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># If you group_by the columns you will facet by, this will work well.</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">someData =<span class="st"> </span>someData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(AgeG)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co"># We can now supply the newAtlas as an atlas to ggseg</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(<span class="dt">.data =</span> someData, <span class="dt">atlas=</span>dkt, <span class="dt">colour=</span><span class="st">"white"</span>, <span class="dt">mapping=</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">fill=</span>p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>AgeG, <span class="dt">ncol=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span>(<span class="dt">colours =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"royalblue"</span>,<span class="st">"firebrick"</span>,<span class="st">"goldenrod"</span>),<span class="dt">na.value=</span><span class="st">"grey"</span>)</a></code></pre></div>
<p><img src="externalData_files/figure-html/duplicate-1.png" width="700"></p>
<p>This whole procedure can be piped together, so you dont have to save all the intermediate steps.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">someData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(AgeG) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/ggseg.html">ggseg</a></span>(<span class="dt">atlas=</span>dkt, <span class="dt">colour=</span><span class="st">"white"</span>, <span class="dt">mapping=</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">fill=</span>p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>AgeG, <span class="dt">ncol=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span>(<span class="dt">colours =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"royalblue"</span>,<span class="st">"firebrick"</span>,<span class="st">"goldenrod"</span>),<span class="dt">na.value=</span><span class="st">"grey"</span>)</a></code></pre></div>
<p><img src="externalData_files/figure-html/duplicatepipe-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#inspecting-the-atlas-labels">Inspecting the atlas labels</a></li>
      <li><a href="#structuring-data-for-merging">Structuring data for merging</a></li>
      <li><a href="#providing-data-to-ggseg">Providing data to <code>ggseg</code></a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Athanasia Mo Mowinckel, Didac Vidal Pineiro.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
